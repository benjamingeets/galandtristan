---
import '../style/app.css'
import Navbar from '../components/Navbar.svelte';
import Footer from "../components/Footer.svelte"
import Social from "../components/Social.svelte"
import GetMeta from '../queries/meta';
import GetSocialLinks from '../queries/social';
import GetHomepage from "../queries/homepage"
import Contact from '../components/Contact.svelte';
const home = await GetHomepage(process.env.NETLIFY ? process.env.TOKEN : import.meta.env.TOKEN)
const token = process.env.NETLIFY ? process.env.TOKEN : import.meta.env.TOKEN
const social = await GetSocialLinks(token)
const meta = await GetMeta(token);
const {title} = Astro.props
const url = new URL(Astro.canonicalURL)
let displayTitle = title ? title + " " + meta.globalSeo.titleSuffix : meta.globalSeo.siteName + " " + meta.globalSeo.titleSuffix
---
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{displayTitle}</title>
    <link rel="icon" type="image/x-icon" href={meta.favicon.url}>

</head>
<body class="lg:px-20">
    <Navbar client:load icon={meta.favicon.url} currentUrl={url} socialLinks={social}/>
    <Social links={social} position="layout"/>
    <slot/>
    <Contact  services={home.index.servicesDuFormulaire}//>
    <Footer/>
    <script>
        import "../scripts/app.js"
    </script>
</body>
</html>